{"version":3,"sources":["assets\\Script\\Shared\\Main.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { SocketAdapter } from \"../com/SocketAdapter\";\r\nimport EventType from \"../event/EventType\";\r\nimport GMTips from \"../tips/GMTips\";\r\nimport { Global } from \"./GloBal\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n/**视图修改抗锯齿平滑度*/\r\ncc.macro.ENABLE_WEBGL_ANTIALIAS = true;\r\n@ccclass\r\nexport default class Main extends cc.Component {\r\n    @property(cc.Label)\r\n    initLabel: cc.Label = null;\r\n    @property()\r\n    sceneType = \"Main\";\r\n    @property(cc.Node)\r\n    initGroup: cc.Node = null;\r\n    @property(cc.Node)\r\n    tipsLayar: cc.Node = null;\r\n\r\n    initGlobal() {\r\n        window[\"Global\"] = Global;\r\n        this.initLabel.string = '初始化中';\r\n    }\r\n    protected start(): void {\r\n        Global.Utils.debugOutput(\"Main ==> start\")\r\n\r\n    }\r\n    onLoad() {\r\n        if(Global.isInit){\r\n            Global.DialogManager.init(this.node);\r\n            this.CreateMainLobbyPannel();\r\n            return;\r\n        }\r\n        Global.Utils.debugOutput(\"Main ==> onLoad\")\r\n        // 初始化全局变量\r\n        this.initGlobal();\r\n        Global.isInit=true;\r\n        // 适配处理\r\n        // Global.CCHelper.screenAdaptation(new cc.Size(1080, 1920), this.node.getComponent(cc.Canvas));\r\n        // 初始化界面管理器\r\n        Global.Utils.debugOutput(\"Main ==> 初始化界面管理器\")\r\n        Global.DialogManager.init(this.node);\r\n        Global.Utils.debugOutput(\"Main ==> 初始化界面管理器over\")\r\n        //音乐音效初始化\r\n        // Global.AudioManager.init();\r\n        // 初始化网络\r\n        Global.Utils.debugOutput(\"Main ==> 初始化网络\")\r\n        Global.GameProtocol.initProtocol();\r\n        Global.Utils.debugOutput(\"Main ==> 初始化网络over\")\r\n        Global.mgr.socketMgr.config(SocketAdapter);\r\n        Global.Utils.debugOutput(\"Main ==> cc.game = \"+cc.game)\r\n        cc.game.on(cc.game.EVENT_HIDE, this.onEventHide.bind(this));\r\n        cc.game.on(cc.game.EVENT_HIDE, this.onEventShow.bind(this));\r\n        this.enterGame();\r\n        cc.systemEvent.on(\"keydown\", this.onKeyDown, this);\r\n    }\r\n    private gm:GMTips;\r\n    private onKeyDown(e : cc.Event.EventKeyboard){\r\n        if(e.keyCode == 192){\r\n            if(this.gm){\r\n                this.gm.disTory();\r\n                this.gm = null;\r\n            }else{\r\n                Global.DialogManager.createDialog('tips/GM/prefab/GMTips', null , (any,createDialog)=>{\r\n                    createDialog.x = 58;\r\n                    createDialog.y = -1250;\r\n                    this.gm = createDialog.getComponent(GMTips);\r\n                    this.gm.onRemove(()=>{\r\n                        this.gm = null;\r\n                    })\r\n                } , this.tipsLayar)\r\n            }\r\n        }\r\n    }\r\n    enterGame() {\r\n        let _this = this;\r\n        let cb = function () {\r\n            _this.notifyNativeLaunched();\r\n            this.initGroup.destroy();\r\n        }.bind(this);\r\n        // Global.mgr.socketMgr.createSocketByUrl(\"ws://192.168.0.24/WebGateSrv/Webgate\")\r\n        // Global.mgr.socketMgr.createSocketByUrl(\"ws://192.168.0.18:8080/WebGateSrv/Webgate\")\r\n        Global.mgr.socketMgr.createSocketByUrl(\"ws://192.168.0.11/Webgate\")\r\n        Global.EventCenter.addEventListener(EventType.LOGIN_OK , this.onLoginOk , this);\r\n        Global.DialogManager.createDialog('login/prefab/LoginPanel', null, cb);\r\n    }\r\n    private CreateMainLobbyPannel():void{\r\n        Global.DialogManager.createDialog('mainLobby/prefab/MainLobbyPanel',null,(any,createDialog)=>{\r\n            createDialog.y = 0;\r\n        });\r\n    }\r\n    \r\n    onLoginOk(type , data){\r\n        Global.DialogManager.createDialog('mainLobby/prefab/MainLobbyPanel', null, ()=>{\r\n            Global.DialogManager.destroyDialog('login/prefab/LoginPanel' , true)\r\n        })\r\n    }\r\n    private notifyNativeLaunched(){\r\n        if( CC_JSB ){\r\n            Global.Utils.debugOutput(\"notifyNativeLaunched\")\r\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"onGameLoaded\", \"()V\");\r\n        }\r\n    }\r\n    onEventHide() {\r\n        Global.MessageCallback.emitMessage(\"GAME_EVENT\", cc.game.EVENT_HIDE);\r\n    }\r\n    onEventShow() {\r\n        Global.MessageCallback.emitMessage(\"GAME_EVENT\", cc.game.EVENT_SHOW);\r\n    }\r\n    onDestroy() {\r\n        cc.game.off(cc.game.EVENT_HIDE, this.onEventHide.bind(this));\r\n        cc.game.off(cc.game.EVENT_HIDE, this.onEventShow.bind(this));\r\n    }\r\n}\r\n"]}