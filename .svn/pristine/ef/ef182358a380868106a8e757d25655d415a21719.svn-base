{"version":3,"sources":["assets\\Script\\Shared\\CCHelper.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { Global } from \"./GloBal\";\r\nimport MD5 from \"./MD5\";\r\nimport MessageCallback from \"./MessageCallback\";\r\nimport Utils from \"./Utils\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class CCHelper {\r\n    private static _ins: CCHelper;\r\n    public static get ins() {\r\n        return this._ins || (this._ins = new CCHelper());\r\n    }\r\n    /**\r\n     * @param res 资源路径(不带后缀,带resources)\r\n     * @param cb 异步创建，function(err, node)\r\n     */\r\n    public createFrameAnimationNode = function (res, cb) {\r\n        //cc.JsonAsset\r\n        cc.loader.loadRes(res + \"_config\", cc.Asset, function (err, data) {\r\n            if (!!err) {\r\n                cc.error(\"createFrameAnimation err: load file fail url=\" + res + '.json');\r\n                cb(\"load file fail\");\r\n            } else {\r\n                data = data.json;\r\n                let width = data[\"width\"] || 0;\r\n                let height = data[\"height\"] || 0;\r\n                let count = data[\"count\"] || 0;\r\n                let intervalTime = (data[\"intervalTime\"] || 0);\r\n                if (width <= 0 || height <= 0 || count <= 0 || intervalTime <= 0) {\r\n                    cc.error(\"animation data err\");\r\n                    cb(\"animation data err\");\r\n                    return;\r\n                }\r\n                cc.loader.loadRes(cc.url.raw(res + '.png'), function (err, texture) {\r\n                    if (!!err) {\r\n                        cc.error(\"createFrameAnimation err: load file fail url=\" + res + '.png');\r\n                        cb(\"load file fail\");\r\n                    } else {\r\n                        let wCount = Math.floor(texture.width / width) || 1;\r\n                        let hCount = Math.floor(texture.height / height) || 1;\r\n\r\n                        let node = new cc.Node();\r\n                        let sprite: cc.Sprite = node.addComponent(cc.Sprite);\r\n                        sprite.spriteFrame = new cc.SpriteFrame(texture, new cc.Rect(0, 64, width, height));\r\n                        /**\r\n                         * @param loop 是否循环，默认false\r\n                         * @param speed 播放速度，默认1\r\n                         * @param completeCallback，每完成一次的回调\r\n                         */\r\n                        node[\"startAnimation\"] = function (loop, speed, completeCallback) {\r\n                            if (!speed || speed <= 0) speed = 1;\r\n                            intervalTime = intervalTime / speed;\r\n                            node.stopAllActions();\r\n                            let index = 0;\r\n                            function callback() {\r\n                                let curIndex = index++ % data.count;\r\n                                let rect = new cc.Rect((curIndex % wCount) * width, Math.floor(curIndex / hCount) * height, width, height);\r\n                                sprite.spriteFrame = new cc.SpriteFrame(texture, rect);\r\n                                if (!!completeCallback && (curIndex === (data.count - 1))) {\r\n                                    completeCallback();\r\n                                }\r\n                            }\r\n                            if (!!loop) {\r\n                                node.runAction(cc.repeatForever(cc.sequence([cc.delayTime(intervalTime), cc.callFunc(callback)])));\r\n                            } else {\r\n                                node.runAction(cc.repeat(cc.sequence([cc.delayTime(intervalTime), cc.callFunc(callback)]), data.count));\r\n                            }\r\n                        };\r\n                        node[\"stopAnimation\"] = function () {\r\n                            node.stopAllActions();\r\n                        };\r\n                        cb(null, node);\r\n                    }\r\n                })\r\n            }\r\n        });\r\n    };\r\n\r\n    // 获取单位向量\r\n    public getUnitVector = function (startPoint, endPoint) {\r\n        let point = cc.v2(0, 0);\r\n        let distance;\r\n        distance = Math.pow((startPoint.x - endPoint.x), 2) + Math.pow((startPoint.y - endPoint.y), 2);\r\n        distance = Math.sqrt(distance);\r\n        if (distance === 0) return point;\r\n        point.x = (endPoint.x - startPoint.x) / distance;\r\n        point.y = (endPoint.y - startPoint.y) / distance;\r\n        return point;\r\n    };\r\n\r\n    public getRelativePosition = function (childNode, parentNode) {\r\n        return parentNode.convertToNodeSpace(childNode.parent.convertToWorldSpace(childNode.position));\r\n    };\r\n\r\n    public setPageTitle = function (titleText) {\r\n        if (!cc.sys.isBrowser) return;\r\n        document.title = titleText;\r\n    };\r\n\r\n    //跨域图片或者本地图片\r\n    public updateSpriteFrame = function (imgUrl, target_, cb=null) {\r\n        let target = target_;\r\n        if(imgUrl==\"\"||imgUrl==undefined||imgUrl==null){\r\n            return;\r\n        }\r\n        if ((imgUrl && imgUrl.indexOf('http') > 0)) {\r\n            cc.loader.load({ url: imgUrl, type: \"png\" }, function (err, texture) {\r\n                if (!!err) {\r\n                    cc.error(err);\r\n                    Global.Utils.invokeCallback(cb, err);\r\n                } else {\r\n                    if (target.isValid) {\r\n                        target.spriteFrame = new cc.SpriteFrame(texture);\r\n                        Global.Utils.invokeCallback(cb);\r\n                    }\r\n                }\r\n            });\r\n            //加载本地图片\r\n        } else {\r\n            cc.loader.loadRes(imgUrl, cc.SpriteFrame, function (err, spriteFrame) {\r\n                if (!!err) {\r\n                    cc.log(err);\r\n                    Global.Utils.invokeCallback(cb, err);\r\n                } else {\r\n                    if (target.isValid) {\r\n                        target.spriteFrame = spriteFrame;\r\n                        Global.Utils.invokeCallback(cb);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    public loadRes = function (dirArr, cb) {\r\n        let loadingCount = 0;\r\n        for (let i = 0; i < dirArr.length; i++) {\r\n            cc.loader.loadResDir(dirArr[i], function (err) {\r\n                loadingCount += 1;\r\n                if (loadingCount >= (dirArr.length)) {\r\n                    Global.Utils.invokeCallback(cb, err);\r\n                }\r\n            }.bind(this));\r\n        }\r\n    };\r\n\r\n    public releaseRes = function (dirArr) {\r\n        for (let i = 0; i < dirArr.length; i++) {\r\n            cc[\"assetManager\"].releaseAsset(dirArr[i]);\r\n            //cc.loader.releaseResDir(dirArr[i]);\r\n        }\r\n    };\r\n\r\n    public createSpriteNode = function (src) {\r\n        let node = new cc.Node();\r\n        let sprite: cc.Sprite = node.addComponent(cc.Sprite);\r\n        sprite.spriteFrame = new cc.SpriteFrame();\r\n        this.updateSpriteFrame(src, sprite);\r\n        return node;\r\n    };\r\n\r\n    // 刷新对齐\r\n    public updateNodeAlignment = function (node) {\r\n        let widget = node.getComponent(cc.Widget);\r\n        if (!!widget) {\r\n            widget.updateAlignment();\r\n        }\r\n        for (let i = 0; i < node.children.length; ++i) {\r\n            this.updateNodeAlignment(node.children[i]);\r\n        }\r\n    };\r\n\r\n    // 屏幕适配\r\n    public screenAdaptation = function (baseSize, canvas) {\r\n        let size = cc.size(baseSize.width, baseSize.height);\r\n        let frameSize = cc.view.getFrameSize();\r\n        /*if (size.height/size.width < frameSize.height/frameSize.width){\r\n            size.height = size.width * (frameSize.height / frameSize.width);\r\n        } else {\r\n            return;\r\n        }*/\r\n        //size.width = size.height * (frameSize.width/frameSize.height);\r\n        if (size.height / size.width < frameSize.height / frameSize.width) {\r\n            //size.height = size.width * (frameSize.height / frameSize.width);`\r\n            canvas.fitHeight = false;\r\n            canvas.fitWidth = true;\r\n        } else {\r\n            size.width = size.height * (frameSize.width / frameSize.height);\r\n            canvas.designResolution = size;\r\n\r\n            canvas.node.width = size.width;\r\n            canvas.node.height = size.height;\r\n        }\r\n\r\n        if (cc.sys.isNative || true) return;\r\n        cc.view.setResizeCallback(function () {\r\n            size = cc.size(baseSize.width, baseSize.height);\r\n            frameSize = cc.view.getFrameSize();\r\n            if (size.height / size.width < frameSize.height / frameSize.width) {\r\n                size.height = size.width * (frameSize.height / frameSize.width);\r\n            } else {\r\n                size.width = size.height * (frameSize.width / frameSize.height);\r\n            }\r\n            canvas.designResolution = size;\r\n            canvas.node.width = size.width;\r\n            canvas.node.height = size.height;\r\n\r\n            MessageCallback.ins.emitMessage(\"DesignResolutionChanged\", size);\r\n\r\n            this.updateNodeAlignment(canvas.node);\r\n        });\r\n    };\r\n\r\n    public playPreSound = function () {\r\n        cc.loader.loadRes('Sound/button', function (err, clip) {\r\n            if (!!err) { } else {\r\n                cc.audioEngine.play(clip, false, 1);\r\n            }\r\n        });\r\n    };\r\n}"]}