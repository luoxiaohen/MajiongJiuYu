{"version":3,"sources":["assets\\Script\\UI\\pieChart\\PieChartPanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { Global } from \"../../Shared/GloBal\";\r\nimport UIBase from \"../../UIBase\";\r\nimport PieChartItem from \"./PieChartItem\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class PieChartPanel extends UIBase {\r\n    start () {\r\n\r\n    }\r\n    @property(cc.Node)\r\n    group_0 : cc.Node = null;\r\n    @property(cc.Node)\r\n    group_1 : cc.Node = null;\r\n    @property(cc.Node)\r\n    group_2 : cc.Node = null;\r\n    @property(cc.Node)\r\n    group_3 : cc.Node = null;\r\n    @property(cc.Node)\r\n    group_4 : cc.Node = null;\r\n    @property(cc.Node)\r\n    group_5 : cc.Node = null;\r\n\r\n\r\n    private picChartPrefab : cc.Prefab;\r\n\r\n    /****牌型数据集合*/\r\n    private _allDataList = {\r\n        0: { data: { 0: 5, 1: 5, 2: 5, 3: 5 }, count: 20 },\r\n        1: { data: { 0: 50, 1: 50, 2: 50, 3: 50 }, count: 200 },\r\n        2: { data: { 0: 20, 1: 40, 2: 15, 3: 5 }, count: 80 },\r\n        3: { data: { 0: 10, 1: 15, 2: 10, 3: 35 }, count: 70 },\r\n        4: { data: { 0: 10, 1: 5, 2: 5, 3: 0 }, count: 20 },\r\n        5: { data: { 0: 25, 1: 35, 2: 0, 3: 0 }, count: 60 },\r\n    };\r\n    public get allDataList() {\r\n        return this._allDataList;\r\n    }\r\n    public set allDataList(value) {\r\n        this._allDataList = value;\r\n    }\r\n    /***主属性画板集合*/\r\n    private ctxArray :Array<cc.Graphics>= [];\r\n\r\n    /**当前选中的主属性*/\r\n    private nowSelect : cc.Graphics;\r\n    /**当前选中的主属性序号*/\r\n    private nowSelectKey : number = -1;\r\n    /**是否还在属性选择动画进行中*/\r\n    private isSHowAction : boolean = false;\r\n\r\n    /***主属性颜色集合*/\r\n    private baseColor : Array<cc.Color> = [cc.color(160,221,224,255),\r\n                                            cc.color(125,145,211,255),\r\n                                            cc.color(75,189,209,255),\r\n                                            cc.color(97,199,56,255),\r\n                                            cc.color(229,195,59,255),\r\n                                            cc.color(228,105,62,255),\r\n                                        ];\r\n    /***主属性颜色集合*/\r\n    private moreColor : Array<cc.Color> = [cc.color(227,15,15,255),\r\n                                            cc.color(19,1,1,255),\r\n                                            cc.color(20,168,214,255),\r\n                                            cc.color(13,241,159,255)\r\n                                        ];\r\n    protected onLoad(): void {\r\n        this.picChartPrefab = Global.Utils.getPreFabBySource('pieChart/prefab/PieChartItem');\r\n        this.createBasePic();\r\n        this.addEvent();\r\n    }\r\n    addEvent(){\r\n    }\r\n    /**添加主属性饼图*/\r\n    private createBasePic(){\r\n        let allBase : number = this.getAllBase();\r\n        let nowValue : number;\r\n        let lastP : number = 0;\r\n        for(let key in this.allDataList){\r\n            nowValue = this.allDataList[key].count/allBase;\r\n            var ctx:cc.Graphics = this[\"group_\" + key].getChildByName(\"baseGroup\").getComponent(cc.Graphics);\r\n            ctx.clear();\r\n            ctx.fillColor = this.baseColor[Number(key)];\r\n            ctx.moveTo(0,0);\r\n            ctx.arc(0, 0, 246,  0, Math.PI * nowValue*2, true);\r\n            ctx.lineTo(0,0);\r\n            ctx.strokeColor = cc.color(160,221,224,1);\r\n            ctx.stroke();\r\n            ctx.fill();\r\n            lastP += nowValue;\r\n            let newMax : number = 360/allBase*this.allDataList[key].count;\r\n            for(let i = 0 ; i < newMax ; i++){\r\n                let item = cc.instantiate(this.picChartPrefab);\r\n                item.getComponent(PieChartItem).setClick(key , this.onItemClick , this )\r\n                this[\"group_\" + key].addChild(item);\r\n                item.angle = i - 90;\r\n            }\r\n            this[\"group_\" + key].angle = -lastP*360 + 90;\r\n            this.ctxArray.push(ctx);\r\n        }\r\n    }\r\n    /**\r\n     * 饼图个体点击\r\n    */\r\n    onItemClick(key : string){\r\n        if(this.isSHowAction){\r\n            return ;\r\n        }\r\n        if(Number(key) == this.nowSelectKey){\r\n            return;\r\n        }\r\n        this.isSHowAction = true;\r\n        if(this.nowSelect){\r\n            let nowGrou : cc.Node = this[\"group_\"+this.nowSelectKey];\r\n            for(let i = 0 ; i < 4 ; i++){\r\n                let moreGroup = nowGrou.getChildByName(\"moreGroup_\" + i)\r\n                let ctx = moreGroup.getComponent(cc.Graphics)\r\n                ctx.clear();\r\n            }\r\n            cc.tween(this.nowSelect.node).to(0.2 , {scaleX : 1 , scaleY : 1}).start();\r\n        }\r\n        cc.tween(this.ctxArray[Number(key)].node).to(0.2 , {scaleX : 1.05 , scaleY : 1.05}).call(()=>{\r\n            this.isSHowAction = false;\r\n            this.nowSelect = this.ctxArray[Number(key)];\r\n            this.nowSelectKey = Number(key);\r\n            this.isSHowMoreData();\r\n        }).start();\r\n    }\r\n    private isSHowMoreData(){\r\n        let nowGrou : cc.Node = this[\"group_\"+this.nowSelectKey];\r\n        let moreGroup : cc.Node ;\r\n        let ctx : cc.Graphics;\r\n        let nowValue : number;\r\n        let nowData = this.allDataList[this.nowSelectKey.toString()].data;\r\n        let lastP : number = 0;\r\n        for(let key in nowData){\r\n            moreGroup = nowGrou.getChildByName(\"moreGroup_\" + key)\r\n            ctx = moreGroup.getComponent(cc.Graphics)\r\n            nowValue = nowData[key]/this.getAllBase();\r\n            ctx.clear();\r\n            ctx.fillColor = this.moreColor[Number(key)];\r\n            ctx.moveTo(0,0);\r\n            ctx.arc(0, 0, 290,  0, nowValue*Math.PI*2, true);\r\n            ctx.lineTo(0,0);\r\n            ctx.strokeColor = cc.color(160,221,224,1);\r\n            ctx.stroke();\r\n            ctx.fill();\r\n            let texmpKey : number = this.nowSelectKey > 0 ? this.nowSelectKey - 1 : 0;\r\n            // moreGroup.angle = ;\r\n            lastP += nowValue;\r\n        }\r\n\r\n       \r\n    }\r\n    /***获取所有主属性数据条数*/\r\n    getAllBase(){\r\n        let allBase:number = 0;\r\n        for(let key in this.allDataList){\r\n            allBase += this.allDataList[key].count;\r\n        }\r\n        return allBase;\r\n    }\r\n}\r\n"]}